"""
å°çº¢ä¹¦å†…å®¹æ¨¡æ¿åº“
åŒ…å«å„ç§ç±»å‹çš„æ–‡æ¡ˆæ¨¡æ¿å’Œæç¤ºè¯
"""

from typing import Dict, List
from enum import Enum


class TemplateType(Enum):
    """æ¨¡æ¿ç±»å‹"""
    TITLE = "æ ‡é¢˜æ¨¡æ¿"
    CONTENT = "å†…å®¹æ¨¡æ¿"
    HASHTAG = "è¯é¢˜æ ‡ç­¾æ¨¡æ¿"
    OPENING = "å¼€å¤´æ¨¡æ¿"
    ENDING = "ç»“å°¾æ¨¡æ¿"


class XiaohongshuTemplates:
    """å°çº¢ä¹¦æ–‡æ¡ˆæ¨¡æ¿åº“"""
    
    # æ ‡é¢˜æ¨¡æ¿
    TITLE_TEMPLATES = {
        "ç¾å¦†æŠ¤è‚¤": [
            "{äº§å“å}çœŸçš„ç»ç»å­ï¼{æ•ˆæœ}å¤ªæƒŠå–œäº†ğŸ’•",
            "å§å¦¹ä»¬ï¼è¿™ä¸ª{äº§å“ç±»å‹}æˆ‘è¦å¹çˆ†ğŸ”¥{æ•ˆæœ}",
            "{æ—¶é—´}ç”¨{äº§å“å}ï¼Œ{æ•ˆæœ}åˆ°å“­ğŸ˜­",
            "ä¹°å®ƒä¹°å®ƒï¼{äº§å“å}{æ•ˆæœ}çœŸçš„å¤ªé¦™äº†âœ¨",
            "å¹³ä»·{äº§å“ç±»å‹}å¤©èŠ±æ¿ï¼{æ•ˆæœ}ä¸è¾“å¤§ç‰ŒğŸ’°"
        ],
        "æ—¶å°šç©¿æ­": [
            "{é£æ ¼}ç©¿æ­å…¬å¼ï¼{åœºåˆ}è¿™æ ·ç©¿è¶…{æ•ˆæœ}âœ¨",
            "{èº«æ}å¥³å­©çš„{å­£èŠ‚}ç©¿æ­æ”»ç•¥ğŸ‘—{æ•ˆæœ}",
            "{ä»·ä½}{å•å“}æ­é…æŒ‡å—ï¼{æ•ˆæœ}åˆ°é£èµ·ğŸ”¥",
            "{é£æ ¼}é£ç©¿æ­æ¨¡æ¿ï¼ç…§ç€ç©¿å°±å¾ˆ{æ•ˆæœ}ğŸ’•",
            "{å•å“}çš„{æ•°é‡}ç§ç©¿æ³•ï¼{æ•ˆæœ}åˆ{æ•ˆæœ2}ğŸ‘Œ"
        ],
        "ç¾é£Ÿæ¢åº—": [
            "{åœ°ç‚¹}è¿™å®¶{é¤å…ç±»å‹}ç»äº†ï¼{ç‰¹è‰²}å¤ª{è¯„ä»·}ğŸ˜‹",
            "ç»ˆäºæ‰¾åˆ°{å£å‘³}{é¤å…ç±»å‹}ï¼{ç‰¹è‰²}çˆ±äº†çˆ±äº†ğŸ’•",
            "{åœ°ç‚¹}å®è—{é¤å…ç±»å‹}ï¼{ç‰¹è‰²}{ä»·ä½}çœŸé¦™ğŸ”¥",
            "å§å¦¹ä»¬å†²ï¼{é¤å…å}{ç‰¹è‰²}yydsâœ¨",
            "{èŠ‚æ—¥}å¿…å»ï¼{åœ°ç‚¹}{é¤å…ç±»å‹}{ç‰¹è‰²}ç»ç»å­ğŸ‰"
        ],
        "æ—…è¡Œæ”»ç•¥": [
            "{ç›®çš„åœ°}{å¤©æ•°}æ¸¸æ”»ç•¥ï¼{ç‰¹è‰²}è¶…{è¯„ä»·}âœˆï¸",
            "{ç›®çš„åœ°}æ—…è¡Œé¿é›·æŒ‡å—ï¼{å»ºè®®}å¿…çœ‹ğŸ‘€",
            "{é¢„ç®—}ç©è½¬{ç›®çš„åœ°}ï¼{ç‰¹è‰²}æ”»ç•¥æ¥äº†ğŸ—ºï¸",
            "{ç›®çš„åœ°}å°ä¼—æ™¯ç‚¹ï¼{ç‰¹è‰²}äººå°‘æ™¯ç¾ğŸ“¸",
            "{å­£èŠ‚}å»{ç›®çš„åœ°}ï¼{ç‰¹è‰²}{è¯„ä»·}åˆ°ç‚¸è£‚ğŸ”¥"
        ],
        "ç”Ÿæ´»æ–¹å¼": [
            "{ä¸»é¢˜}ç”Ÿæ´»æ–¹å¼åˆ†äº«ï¼{æ•ˆæœ}å¤ª{è¯„ä»·}äº†âœ¨",
            "{æ—¶é—´æ®µ}{ä¹ æƒ¯}è®©æˆ‘{æ•ˆæœ}ï¼åšæŒ{æ—¶é•¿}ğŸ’ª",
            "{ä¸»é¢˜}æ—¥å¸¸ï¼{æ•ˆæœ}çš„{æ•°é‡}ä¸ªå°æŠ€å·§ğŸŒŸ",
            "åˆ†äº«æˆ‘çš„{ä¸»é¢˜}å¥½ç‰©ï¼{æ•ˆæœ}æå‡{ç¨‹åº¦}ğŸ“ˆ",
            "{ä¸»é¢˜}vlogï¼{æ•ˆæœ}çš„ä¸€å¤©è®°å½•ğŸ’•"
        ]
    }
    
    # å†…å®¹å¼€å¤´æ¨¡æ¿
    OPENING_TEMPLATES = {
        "æƒŠå–œå‘ç°": [
            "å§å¦¹ä»¬ï¼æˆ‘å‘ç°äº†ä¸€ä¸ªå®è—{ç±»å‹}ğŸ’",
            "çœŸçš„æ˜¯æ„å¤–æƒŠå–œï¼æ²¡æƒ³åˆ°{äº§å“/åœ°ç‚¹}{æ•ˆæœ}",
            "ä»Šå¤©è¦æ¥åˆ†äº«ä¸€ä¸ªè¶…çº§æƒŠå–œçš„å‘ç°âœ¨",
            "ä¸å¾—ä¸è¯´ï¼Œè¿™æ¬¡çœŸçš„æ˜¯æ¡åˆ°å®äº†ğŸ¯"
        ],
        "é—®é¢˜è§£å†³": [
            "è¿˜åœ¨ä¸º{é—®é¢˜}çƒ¦æ¼å—ï¼Ÿè¿™ä¸ªæ–¹æ³•ç»äº†ğŸ”¥",
            "ç»ˆäºè§£å†³äº†å›°æ‰°æˆ‘å¾ˆä¹…çš„{é—®é¢˜}ğŸ’ª",
            "å§å¦¹ä»¬æ˜¯ä¸æ˜¯éƒ½æœ‰{é—®é¢˜}çš„å›°æ‰°ï¼Ÿ",
            "å¦‚æœä½ ä¹Ÿæœ‰{é—®é¢˜}ï¼Œä¸€å®šè¦è¯•è¯•è¿™ä¸ªæ–¹æ³•ğŸ‘‡"
        ],
        "ç»éªŒåˆ†äº«": [
            "ä½œä¸º{èº«ä»½}ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€äº›{ä¸»é¢˜}ç»éªŒğŸ“š",
            "ç”¨äº†{æ—¶é—´}æ€»ç»“å‡ºæ¥çš„{ä¸»é¢˜}å¿ƒå¾—ğŸ’¡",
            "ä»Šå¤©æ¥åˆ†äº«æˆ‘çš„{ä¸»é¢˜}å¹²è´§ï¼è¶…å®ç”¨âœ¨",
            "è¸©è¿‡å‘æ‰çŸ¥é“ï¼Œ{ä¸»é¢˜}åŸæ¥è¦è¿™æ ·åšğŸ˜…"
        ],
        "æµ‹è¯„å¯¹æ¯”": [
            "ç»ˆäºæµ‹è¯„å®Œäº†{æ•°é‡}ä¸ª{äº§å“}ï¼ç»“æœå¤ªæ„å¤–ğŸ˜±",
            "èŠ±äº†{é‡‘é¢}æµ‹è¯•{äº§å“}ï¼Œå“ªä¸ªæœ€å€¼å¾—ä¹°ï¼Ÿ",
            "å®æµ‹{æ•°é‡}æ¬¾{äº§å“}ï¼Œå·®è·çœŸçš„å¾ˆå¤§ğŸ“Š",
            "äº²æµ‹å‘Šè¯‰ä½ ï¼Œ{äº§å“A}vs{äº§å“B}å“ªä¸ªæ›´å¥½ğŸ‘€"
        ]
    }
    
    # å†…å®¹ç»“å°¾æ¨¡æ¿
    ENDING_TEMPLATES = {
        "äº’åŠ¨å¼•å¯¼": [
            "ä½ ä»¬è¿˜æœ‰ä»€ä¹ˆæƒ³çŸ¥é“çš„ï¼Ÿè¯„è®ºåŒºèŠèŠğŸ’¬",
            "æœ‰æ²¡æœ‰å§å¦¹å’Œæˆ‘ä¸€æ ·{æ„Ÿå—}çš„ï¼Ÿä¸¾ä¸ªæ‰‹ğŸ™‹â€â™€ï¸",
            "è¿˜æœ‰ä»€ä¹ˆ{ä¸»é¢˜}å¥½ç‰©æ¨èå—ï¼Ÿåˆ†äº«ä¸€ä¸‹âœ¨",
            "ä½ ä»¬è§‰å¾—æ€ä¹ˆæ ·ï¼Ÿå¿«æ¥è¯„è®ºåŒºå‘Šè¯‰æˆ‘ğŸ‘‡"
        ],
        "è¡ŒåŠ¨å‘¼å": [
            "å¿ƒåŠ¨ä¸å¦‚è¡ŒåŠ¨ï¼èµ¶ç´§å»è¯•è¯•å§ğŸƒâ€â™€ï¸",
            "è¿˜ä¸å¿«å»{è¡ŒåŠ¨}ï¼æ™šäº†å°±æ²¡äº†â°",
            "å»ºè®®æ”¶è—èµ·æ¥æ…¢æ…¢çœ‹ï¼Œå¾ˆå®ç”¨å“¦ğŸ“Œ",
            "è®°å¾—ç‚¹èµå…³æ³¨å“¦ï¼Œåç»­æ›´æ–°æ›´å¤š{å†…å®¹}ğŸ’•"
        ],
        "æƒ…æ„Ÿå…±é¸£": [
            "å¸Œæœ›è¿™ä¸ªåˆ†äº«å¯¹ä½ ä»¬æœ‰å¸®åŠ©â¤ï¸",
            "æ„¿æˆ‘ä»¬éƒ½èƒ½{æ„¿æœ›}ï¼Œä¸€èµ·å˜æ›´å¥½âœ¨",
            "ç”Ÿæ´»å°±æ˜¯è¦å¯¹è‡ªå·±å¥½ä¸€ç‚¹ğŸ’•",
            "æ¯å¤©éƒ½è¦å¼€å¼€å¿ƒå¿ƒçš„å‘€ğŸŒˆ"
        ],
        "æœŸå¾…äº’åŠ¨": [
            "æœŸå¾…ä½ ä»¬çš„ä½¿ç”¨åé¦ˆå“¦ğŸ“",
            "æœ‰ä»€ä¹ˆé—®é¢˜éšæ—¶æ‰¾æˆ‘ï¼Œåœ¨çº¿è§£ç­”ğŸ’Œ",
            "ä¸‹æœŸæƒ³çœ‹ä»€ä¹ˆå†…å®¹ï¼Ÿç•™è¨€å‘Šè¯‰æˆ‘ğŸ‘‚",
            "æˆ‘ä»¬ä¸€èµ·{ç›®æ ‡}å§ï¼å†²å†²å†²ğŸ”¥"
        ]
    }
    
    # è¯é¢˜æ ‡ç­¾æ¨¡æ¿
    HASHTAG_TEMPLATES = {
        "ç¾å¦†æŠ¤è‚¤": [
            "#æŠ¤è‚¤æ—¥è®°", "#ç¾å¦†åˆ†äº«", "#ç§è‰ç¬”è®°", "#æŠ¤è‚¤å¿ƒå¾—",
            "#ç¾å¦†è¯„æµ‹", "#åŒ–å¦†æŠ€å·§", "#æŠ¤è‚¤å“æ¨è", "#ç¾å¦†å¥½ç‰©",
            "#å½©å¦†æ•™ç¨‹", "#æŠ¤è‚¤æ”»ç•¥", "#ç¾å¦†åšä¸»", "#åŒ–å¦†å“æµ‹è¯„"
        ],
        "æ—¶å°šç©¿æ­": [
            "#ç©¿æ­åˆ†äº«", "#ä»Šæ—¥ç©¿æ­", "#ç©¿æ­æ”»ç•¥", "#æ—¶å°šç©¿æ­",
            "#ç©¿æ­æ—¥è®°", "#outfit", "#æ­é…æŠ€å·§", "#ç©¿æ­åšä¸»",
            "#æ—¶å°šåšä¸»", "#ç©¿æ­çµæ„Ÿ", "#æœè£…æ­é…", "#ç©¿æ­æ¨¡æ¿"
        ],
        "ç¾é£Ÿæ¢åº—": [
            "#ç¾é£Ÿæ¢åº—", "#ç¾é£Ÿåˆ†äº«", "#æ¢åº—ç¬”è®°", "#ç¾é£Ÿæ¨è",
            "#é¤å…æ¨è", "#ç¾é£Ÿåšä¸»", "#åƒæ’­", "#ç¾é£Ÿæ”»ç•¥",
            "#æ¢åº—æ—¥è®°", "#ç¾é£Ÿç§è‰", "#é¤å…æµ‹è¯„", "#ç¾é£Ÿvlog"
        ],
        "æ—…è¡Œæ”»ç•¥": [
            "#æ—…è¡Œæ”»ç•¥", "#æ—…æ¸¸åˆ†äº«", "#æ—…è¡Œæ—¥è®°", "#æ—…æ¸¸åšä¸»",
            "#æ—…è¡Œvlog", "#æ™¯ç‚¹æ¨è", "#æ—…æ¸¸æ¨è", "#æ—…è¡Œç§è‰",
            "#å‡ºè¡Œæ”»ç•¥", "#æ—…æ¸¸æ”»ç•¥", "#æ—…è¡Œç¬”è®°", "#åº¦å‡åˆ†äº«"
        ],
        "ç”Ÿæ´»æ–¹å¼": [
            "#ç”Ÿæ´»åˆ†äº«", "#ç”Ÿæ´»è®°å½•", "#æ—¥å¸¸ç”Ÿæ´»", "#ç”Ÿæ´»åšä¸»",
            "#ç”Ÿæ´»vlog", "#ç”Ÿæ´»æ–¹å¼", "#ç”Ÿæ´»æ”»ç•¥", "#ç”Ÿæ´»å¥½ç‰©",
            "#ç”Ÿæ´»å°æŠ€å·§", "#ç”Ÿæ´»æ—¥è®°", "#å±…å®¶ç”Ÿæ´»", "#ç”Ÿæ´»æ„Ÿæ‚Ÿ"
        ]
    }
    
    # å®Œæ•´å†…å®¹æ¨¡æ¿
    COMPLETE_TEMPLATES = {
        "äº§å“æ¨è": """
{å¼€å¤´}

âœ¨ äº§å“ä¿¡æ¯ï¼š
ğŸ“¦ äº§å“åç§°ï¼š{äº§å“å}
ğŸ’° ä»·æ ¼ï¼š{ä»·æ ¼}
ğŸ›’ è´­ä¹°æ¸ é“ï¼š{æ¸ é“}

ğŸ’ ä½¿ç”¨ä½“éªŒï¼š
{ä½“éªŒæè¿°}

â­ æ¨èç†ç”±ï¼š
1ï¸âƒ£ {ç†ç”±1}
2ï¸âƒ£ {ç†ç”±2}
3ï¸âƒ£ {ç†ç”±3}

{ç»“å°¾}

{è¯é¢˜æ ‡ç­¾}
""",
        
        "æ”»ç•¥åˆ†äº«": """
{å¼€å¤´}

ğŸ“ {ä¸»é¢˜}æ”»ç•¥æ¥å•¦ï¼š

ğŸ” å‡†å¤‡å·¥ä½œï¼š
{å‡†å¤‡äº‹é¡¹}

ğŸ“‹ è¯¦ç»†æ­¥éª¤ï¼š
1ï¸âƒ£ {æ­¥éª¤1}
2ï¸âƒ£ {æ­¥éª¤2}
3ï¸âƒ£ {æ­¥éª¤3}

âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
{æ³¨æ„äº‹é¡¹}

ğŸ’¡ å°è´´å£«ï¼š
{å°è´´å£«}

{ç»“å°¾}

{è¯é¢˜æ ‡ç­¾}
""",
        
        "ä½“éªŒåˆ†äº«": """
{å¼€å¤´}

ğŸ“ ä½“éªŒåœ°ç‚¹ï¼š{åœ°ç‚¹}
â° ä½“éªŒæ—¶é—´ï¼š{æ—¶é—´}
ğŸ’° æ¶ˆè´¹é‡‘é¢ï¼š{é‡‘é¢}

ğŸŒŸ ä½“éªŒè¿‡ç¨‹ï¼š
{è¿‡ç¨‹æè¿°}

ğŸ‘ ä¼˜ç‚¹ï¼š
{ä¼˜ç‚¹}

ğŸ‘ ç¼ºç‚¹ï¼š
{ç¼ºç‚¹}

ğŸ“Š ç»¼åˆè¯„åˆ†ï¼š{è¯„åˆ†}/10åˆ†

{ç»“å°¾}

{è¯é¢˜æ ‡ç­¾}
"""
    }
    
    @classmethod
    def get_templates_by_category(cls, category: str) -> Dict[str, List[str]]:
        """æ ¹æ®åˆ†ç±»è·å–æ¨¡æ¿"""
        templates = {}
        
        if category in cls.TITLE_TEMPLATES:
            templates["æ ‡é¢˜"] = cls.TITLE_TEMPLATES[category]
        
        if category in cls.HASHTAG_TEMPLATES:
            templates["è¯é¢˜æ ‡ç­¾"] = cls.HASHTAG_TEMPLATES[category]
        
        templates["å¼€å¤´"] = cls.OPENING_TEMPLATES
        templates["ç»“å°¾"] = cls.ENDING_TEMPLATES
        templates["å®Œæ•´æ¨¡æ¿"] = cls.COMPLETE_TEMPLATES
        
        return templates
    
    @classmethod
    def get_random_template(cls, template_type: TemplateType, category: str = None) -> str:
        """è·å–éšæœºæ¨¡æ¿"""
        import random
        
        if template_type == TemplateType.TITLE and category:
            if category in cls.TITLE_TEMPLATES:
                return random.choice(cls.TITLE_TEMPLATES[category])
        
        elif template_type == TemplateType.HASHTAG and category:
            if category in cls.HASHTAG_TEMPLATES:
                tags = cls.HASHTAG_TEMPLATES[category]
                return " ".join(random.sample(tags, min(6, len(tags))))
        
        elif template_type == TemplateType.OPENING:
            opening_type = random.choice(list(cls.OPENING_TEMPLATES.keys()))
            return random.choice(cls.OPENING_TEMPLATES[opening_type])
        
        elif template_type == TemplateType.ENDING:
            ending_type = random.choice(list(cls.ENDING_TEMPLATES.keys()))
            return random.choice(cls.ENDING_TEMPLATES[ending_type])
        
        return ""
    
    @classmethod
    def generate_structured_prompt(cls, category: str, topic: str, style: str = "æ´»æ³¼") -> str:
        """ç”Ÿæˆç»“æ„åŒ–çš„æç¤ºè¯"""
        
        prompt = f"""
è¯·ä¸ºå°çº¢ä¹¦ç”Ÿæˆä¸€ç¯‡å…³äº"{topic}"çš„{category}å†…å®¹ï¼Œè¦æ±‚ï¼š

ğŸ“‹ å†…å®¹è¦æ±‚ï¼š
1. è¯­æ°”é£æ ¼ï¼š{style}
2. ç›®æ ‡å—ä¼—ï¼šå°çº¢ä¹¦ç”¨æˆ·
3. å†…å®¹é•¿åº¦ï¼š200-400å­—
4. ç»“æ„æ¸…æ™°ï¼Œæ˜“äºé˜…è¯»

ğŸ“ å†…å®¹ç»“æ„ï¼š
1. å¸å¼•äººçš„å¼€å¤´ï¼ˆä½¿ç”¨emojiï¼‰
2. æœ‰ä»·å€¼çš„ä¸»ä½“å†…å®¹ï¼ˆåˆ†ç‚¹æè¿°ï¼‰
3. å¼•å¯¼äº’åŠ¨çš„ç»“å°¾
4. ç›¸å…³è¯é¢˜æ ‡ç­¾

ğŸ¯ ä¼˜åŒ–è¦ç‚¹ï¼š
- é€‚å½“ä½¿ç”¨emojiè¡¨æƒ…
- æ¢è¡Œè¦åˆç†
- è¯­è¨€è¦ç”ŸåŠ¨æœ‰è¶£
- å†…å®¹è¦å®ç”¨æœ‰ä»·å€¼
- ç¬¦åˆå°çº¢ä¹¦è°ƒæ€§

è¯·ç”Ÿæˆå®Œæ•´çš„å°çº¢ä¹¦æ–‡æ¡ˆã€‚
"""
        
        return prompt


def main():
    """æ¼”ç¤ºæ¨¡æ¿ä½¿ç”¨"""
    templates = XiaohongshuTemplates()
    
    print("ğŸ“ å°çº¢ä¹¦å†…å®¹æ¨¡æ¿åº“æ¼”ç¤º")
    print("=" * 40)
    
    # æ¼”ç¤ºè·å–åˆ†ç±»æ¨¡æ¿
    category = "ç¾å¦†æŠ¤è‚¤"
    print(f"ğŸ“‚ {category}åˆ†ç±»æ¨¡æ¿ï¼š")
    
    category_templates = templates.get_templates_by_category(category)
    for template_type, template_list in category_templates.items():
        print(f"\nğŸ·ï¸ {template_type}:")
        if isinstance(template_list, list):
            for i, template in enumerate(template_list[:3], 1):
                print(f"  {i}. {template}")
        elif isinstance(template_list, dict):
            for sub_type, sub_list in list(template_list.items())[:2]:
                print(f"  ğŸ“Œ {sub_type}: {sub_list[0] if sub_list else ''}")
    
    print("\n" + "=" * 40)
    
    # æ¼”ç¤ºéšæœºæ¨¡æ¿
    print("ğŸ² éšæœºæ¨¡æ¿æ¼”ç¤ºï¼š")
    print(f"éšæœºæ ‡é¢˜: {templates.get_random_template(TemplateType.TITLE, category)}")
    print(f"éšæœºå¼€å¤´: {templates.get_random_template(TemplateType.OPENING)}")
    print(f"éšæœºç»“å°¾: {templates.get_random_template(TemplateType.ENDING)}")
    print(f"éšæœºæ ‡ç­¾: {templates.get_random_template(TemplateType.HASHTAG, category)}")
    
    print("\n" + "=" * 40)
    
    # æ¼”ç¤ºç»“æ„åŒ–æç¤ºè¯
    print("ğŸ”§ ç»“æ„åŒ–æç¤ºè¯ï¼š")
    prompt = templates.generate_structured_prompt(category, "å†¬å­£æŠ¤è‚¤ä¿æ¹¿æ”»ç•¥", "ä¸“ä¸šæ¸©å’Œ")
    print(prompt)


if __name__ == "__main__":
    main() 